{% extends 'sidebar.html' %}

{% load static %}

{% block title %} Jagrati | Volunteers List {% endblock %}

{% block content-sidebar %}

<!-- List of Volunteers -->

<div class="dash-vol-list col-md-8 col-lg-9 mt-3">
	<a href="" class="d-inline-block mb-2 mb-md-0">&larr; Back to Dashboard</a>
	<h3 class="text-center">Volunteers Schedule</h3>
	<div class="row justify-content-center">
		<div class="col-md-4 my-3">
			<select name="day" class="custom-select d-block w-100" id="vol-list-day">
				<option value="">Select Day</option>
				{% for j,i in day %}
				<option value="{{j}}">{{i}}</option>
				{% endfor %}
			</select>
		</div>
	</div>
	
	<div class="row justify-content-center d-none my-4 mx-0" id="reg-vol">
		<div class="col-md-9 border rounded">
			<h4 class="text-center mt-3">Registered Volunteers</h4>
			<hr>
			<table class="table table-hover" id="vol-list-table"></table>
		</div>
	</div>
</div>

{% endblock %}

{% block scripts-sidebar %}

<!-- AJAX for Volunteer's List -->

<script>
	$("#vol-list-day option:first").attr('selected', 'selected');
	$("#vol-list-day").change(function () {
		let vol_list_day = $(this).val();

		let reg_vol_div = document.getElementById('reg-vol');
		if(vol_list_day == ""){
			if(!reg_vol_div.classList.contains('d-none')) reg_vol_div.classList.add('d-none');
		} 
		else{
			if(reg_vol_div.classList.contains('d-none')) reg_vol_div.classList.remove('d-none');
		} 

		$.ajax({
			url: '/ajax/volunteer_list/',
			data: {
				'vol_list_day': vol_list_day
			},
			dataType: 'json',
			success: function (data) {
				let vol_list_table = '<thead><tr><th>Roll No.</th><th>Name</th><th>Section</th></tr></thead><tbody>';
				let hello = '';   // Just for fun
					
				// console.log(vol_dict)
				for (var i = 0; i < data.stu_today.length; i++) {

					let first_name = data.volunteers[data.stu_today[i]['roll_no_id']]['first_name'];
					let last_name = data.volunteers[data.stu_today[i]['roll_no_id']]['last_name'];
					let roll_no = data.volunteers[data.stu_today[i]['roll_no_id']]['roll_no'];
					var sec_display = data.choices[data.schedule[data.stu_today[i]['schedule_id']]['section']];
					// console.log(first_name)

					if(true) hello = 'there'  // Just for fun

					vol_list_table += '<tr><td>' + roll_no + '</td><td>' + first_name + ' ' + last_name + '</td><td>' + sec_display + '</td></tr>';
					
				}
				vol_list_table += '</tbody>';
				$("#vol-list-table").html(vol_list_table);
			}
		});
	});
</script>

{% endblock %}